<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>MobileRobot Class Description · Simulation Construction Set</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## 1. Add the following code to the MobileRobot Class"/><meta property="og:title" content="MobileRobot Class Description · Simulation Construction Set"/><meta property="og:type" content="website"/><meta property="og:url" content="https://ihmcroboticsdocs.github.io/simulation-construction-set/index.html"/><meta property="og:description" content="## 1. Add the following code to the MobileRobot Class"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/simulation-construction-set/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/simulation-construction-set/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/simulation-construction-set/"><img class="logo" src="/simulation-construction-set/img/running-man-logo.png" alt="Simulation Construction Set"/><h2 class="headerTitleWithLogo">Simulation Construction Set</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://ihmcroboticsdocs.github.io" target="_self">IHMC Home</a></li><li class=""><a href="https://ihmcroboticsdocs.github.io/docs/docshome.html" target="_self">All IHMC Docs</a></li><li class=""><a href="http://robots.ihmc.us/" target="_self">About IHMC</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Creating Robot with Multiple Joints</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/00-quickstart.html">Quick Start</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/01-requirements.html">Requirements</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/02-jar-releases.html">Using IHMC Open Robotics Software .jar releases with Maven/Gradle</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/03-local-maven-jar.html">Building .jars</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/04-depending-on-source.html">Depending Directly on the Source</a></li></ul></div><div class="navGroup navGroupActive"><h3>Using the SCS GUI</h3><ul><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/00-running-a-simulation.html">Running a simulation</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/01-change-camera-settings.html">Changing the Camera Settings</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/02-variable-view.html">SCS Variables</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/03-create-graph.html">Graphing Variables</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/04-toolbar-playback-and-graphs.html">Simulation Replay</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/05-data-buffer.html">Data Buffer</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/06-export-data.html">Exporting Data</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/07-snapshot.html">Export Snapshots and Video of the 3D View</a></li></ul></div><div class="navGroup navGroupActive"><h3>Creating a New Simulation</h3><ul><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/000-summary.html">Summary</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/01-creating-a-new-project.html">Create a New Project</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/02-simple-pendulum-simulation.html">SimplePendulumSimulation.java</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/03-simple-pendulum-robot.html">SimplePendulumRobot.java</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/04-run-simulation.html">Run the simulation</a></li></ul></div><div class="navGroup navGroupActive"><h3>Adding Control to a Simulation</h3><ul><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/001-summary.html">Summary</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/01-adding-control-to-a-simulation.html">Adding control to a simulation</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/02-run-the-simulation.html">Run the simulation</a></li></ul></div><div class="navGroup navGroupActive"><h3>Creating Links</h3><ul><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/002-summary.html">Summary</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/01-creating-links.html">Creating Links</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/02-run-creating-links.html">Run the Simulation</a></li></ul></div><div class="navGroup navGroupActive"><h3>Creating Robot with Multiple Joints</h3><ul><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/003-summary.html">Summary</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/01-create-new-package.html">Create a New Package</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/02-mobile-simulation.html">Mobile Simulation</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/03-mobile-robot.html">Initial Variables in MobileRobot Class</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/simulation-construction-set/docs/04-mobile-robot-description.html">MobileRobot Class Description</a></li></ul></div><div class="navGroup navGroupActive"><h3>Ground Contact Modeling</h3><ul><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/004-summary.html">Summary</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/01a-create-new-package.html">Create a New Package</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/02-falling-brick-setup.html">Create a New Class FallingBrickSimulation</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/03-falling-brick-robot.html">Create a New Class FallingBrickRobot</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/04-wavy-ground-profile.html">Create a New Class WavyGroundProfile</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/05-description.html">Description and Analysis</a></li></ul></div><div class="navGroup navGroupActive"><h3>Implementing Closed-Chain Mechanisms Using External Force Points</h3><ul><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/005-summary.html">Summary</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/01-implementing-closed-chain-mechanisms.html">Implementing Closed-Chain Mechanisms</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/02-flyball-governor-simulation.html">FlyballGovernorSimulation Class</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/03-flyball-governor-robot.html">FlyballGovernorRobot Class</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/04-flyball-controller.html">FlyballGovernorSimpleClosedLoopConstraintController Class</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/05-flyball-governor-common-control-parameters.html">FlyballGovernorCommonControlParameters Class</a></li><li class="navListItem"><a class="navItem" href="/simulation-construction-set/docs/06-description-and-analysis.html">Description and Analysis</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>MobileRobot Class Description</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="1-add-the-following-code-to-the-mobilerobot-class"></a><a href="#1-add-the-following-code-to-the-mobilerobot-class" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Add the following code to the MobileRobot Class</h2>
<pre><code class="hljs css languages- java">   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MobileRobot</span><span class="hljs-params">()</span>
   </span>{
      <span class="hljs-keyword">super</span>(<span class="hljs-string">"Mobile"</span>);

      <span class="hljs-comment">// create first gimbal joint at the top of the mobile</span>
      GimbalJoint firstGimbal = <span class="hljs-keyword">new</span> GimbalJoint(<span class="hljs-string">"gimbal_x"</span>, <span class="hljs-string">"gimbal_y"</span>, <span class="hljs-string">"gimbal_z"</span>, 
                                                <span class="hljs-keyword">new</span> Vector3d(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>), <span class="hljs-keyword">this</span>, Axis.X, Axis.Y, Axis.Z);
      <span class="hljs-comment">// attach a crossbar to the top gimbal joint</span>
      Link bar1 = crossBar(M1, L1, R1, Ixx1, Iyy1, Izz1);
      firstGimbal.setLink(bar1);
      firstGimbal.setDamping(DAMP1);
      initJoint(firstGimbal);
      <span class="hljs-keyword">this</span>.addRootJoint(firstGimbal);
      <span class="hljs-keyword">double</span> xOffset, yOffset;
      GimbalJoint nextGimbal;
      GimbalJoint finalGimbal;
      Link nextLink;
      <span class="hljs-comment">// for each point of the cross bar, attach a new gimbal joint and (smaller crossbar)</span>
      <span class="hljs-comment">// four toys will hang from each of these smaller crossbars</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)
      {
         xOffset = <span class="hljs-number">0.0</span>;
         yOffset = <span class="hljs-number">0.0</span>;
         <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>)
            xOffset = L1;
         <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">1</span>)
            xOffset = -L1;
         <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">2</span>)
            yOffset = L1;
         <span class="hljs-keyword">else</span> <span class="hljs-comment">// i == 3</span>
            yOffset = -L1;
         nextGimbal = <span class="hljs-keyword">new</span> GimbalJoint(<span class="hljs-string">"gimbal1_"</span> + i + <span class="hljs-string">"_x"</span>, <span class="hljs-string">"gimbal1_"</span> + i + <span class="hljs-string">"_y"</span>, <span class="hljs-string">"gimbal1_"</span> + i + <span class="hljs-string">"_z"</span>,
                                      <span class="hljs-keyword">new</span> Vector3d(xOffset, yOffset, -L1 / <span class="hljs-number">2.0</span>), <span class="hljs-keyword">this</span>, Axis.X, Axis.Y, Axis.Z);
         nextLink = crossBar(M2, L2, R2, Ixx2, Iyy2, Izz2);
         nextGimbal.setLink(nextLink);
         nextGimbal.setDamping(DAMP2);
         initJoint(nextGimbal);
         firstGimbal.addJoint(nextGimbal);
         <span class="hljs-comment">// for each point of the smaller crossbar, add a gimbal joint with a "toy" link attached</span>
         <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++)
         {
            xOffset = <span class="hljs-number">0.0</span>;
            yOffset = <span class="hljs-number">0.0</span>;
            <span class="hljs-keyword">if</span> (j == <span class="hljs-number">0</span>)
               xOffset = L2;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j == <span class="hljs-number">1</span>)
               xOffset = -L2;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j == <span class="hljs-number">2</span>)
               yOffset = L2;
            <span class="hljs-keyword">else</span> <span class="hljs-comment">// j == 3</span>
               yOffset = -L2;
            finalGimbal = <span class="hljs-keyword">new</span> GimbalJoint(<span class="hljs-string">"gimbal2_"</span> + i + <span class="hljs-string">"_"</span> + j + <span class="hljs-string">"_x"</span>, <span class="hljs-string">"gimbal2_"</span> + i + <span class="hljs-string">"_"</span> + j +  <span class="hljs-string">"_y"</span>, <span class="hljs-string">"gimbal2_"</span>
                                          + i + <span class="hljs-string">"_"</span> + j +  <span class="hljs-string">"_z"</span>, <span class="hljs-keyword">new</span> Vector3d(xOffset, yOffset, -L2 / <span class="hljs-number">2.0</span>), <span class="hljs-keyword">this</span>,
                                          Axis.X, Axis.Y, Axis.Z);
             
            <span class="hljs-comment">// generate a random toy link and attach it to gimbal</span>
            nextLink = randomShape();
            finalGimbal.setLink(nextLink);
            <span class="hljs-comment">// add external force point at the toy COM</span>
            Vector3d offset = <span class="hljs-keyword">new</span> Vector3d();
            nextLink.getComOffset(offset);
            ExternalForcePoint point = <span class="hljs-keyword">new</span> ExternalForcePoint(<span class="hljs-string">"ef_track"</span> + i + j, offset, <span class="hljs-keyword">this</span>);
            finalGimbal.addExternalForcePoint(point);
            finalGimbal.setDamping(DAMP3);
            initJoint(finalGimbal);
            nextGimbal.addJoint(finalGimbal);
         }
      }
   }
</code></pre>
<p>Examine the lines where the 3 different levels of gimbal joints are defined. Note how in Java, Strings can be concatenated using <code>&quot; &quot; + &quot; &quot;</code>, and that integers will be turned into Strings in this way. For example, if <code>i=3</code>, then <code>&quot;gimbal1_&quot; + i &quot;_x&quot;</code> will result in <code>&quot;gimbal1_3_x&quot;</code>.</p>
<p>Look at the offset Vector3d for each joint level.</p>
<ul>
<li>The first offset, <code>(0.0, 0.0, 1.0)</code>, simply places the mobile into the air.</li>
<li>The second is <code>(xOffset, yOffset, -L1/2.0)</code> where <code>(xOffset, yOffset)</code> is either <code>(L1, 0)</code>, <code>(-L1, 0)</code>, <code>(0, L1)</code>, or <code>(0, -L1)</code>.
<ul>
<li>This is from the second level of 4 gimbal joints to each of their parent joint, which is the first gimbal joint.</li>
<li>The top crossbar goes down L1/2.0 and in each of the four directions by L1. Therefore, the given offsets should work.</li>
</ul></li>
<li>The third is <code>(xOffset, yOffset, -L2/2.0)</code> where <code>(xOffset, yOffset)</code> is either <code>(L2, 0)</code>, <code>(-L2, 0)</code>, <code>(0, L2)</code>, or <code>(0, -L2)</code>.
<ul>
<li>This is the final level of 16 gimbals from their parents above them. The smaller crossbars go down L2/2.0 and in each of the four directions by L2. Therefore, the given offsets should work.</li>
</ul></li>
</ul>
<p>Note that the joint offsets are completely independent of any translations or rotations which are performed while specifying links:</p>
<p><code>firstGimbal = new GimbalJoint(&quot;gimbal_x&quot;, &quot;gimbal_y&quot;,&quot;gimbal_z&quot;, new Vector3d(0.0,0.0,1.0), this, Axis.X, Axis.Y, Axis.Z);</code></p>
<p><code>nextGimbal = new GimbalJoint(&quot;gimbal1_&quot; + i + &quot;_x&quot;, &quot;gimbal1_&quot; + i + &quot;_y&quot;, &quot;gimbal1_&quot; + i + &quot;_z&quot;, new Vector3d(xOffset, yOffset, -L1 / 2.0), this, Axis.X, Axis.Y, Axis.Z);</code></p>
<p><code>finalGimbal = new GimbalJoint(&quot;gimbal2_&quot; + i + &quot;_&quot; + j + &quot;_x&quot;, &quot;gimbal2_&quot; + i + &quot;_&quot; + j + &quot;_y&quot;, &quot;gimbal2_&quot; + i + &quot;_&quot; + j + &quot;_z&quot;, new Vector3d(xOffset, yOffset, -L2 / 2.0), this, Axis.X, Axis.Y, Axis.Z);</code></p>
<p>Note that viscous damping is set for each joint</p>
<p>Viscous damping of the form tau=damping * velocity will be added on top of any torques due to joint limits or a control system. For this simulation, the mobile is completely passive and damping is the only source of joint torque:</p>
<p><code>firstGimbal.setDamping(DAMP1);</code>  <br>
<code>nextGimbal.setDamping(DAMP2);</code>  <br>
<code>finalGimbal.setDamping(DAMP3);</code></p>
<p>Note that the function initJoint is called for each joint</p>
<p><code>initJoint</code> creates random values for the position and velocity of each of the 3 degrees of freedom for the GimbalJoint and sets the state using <code>GimbalJoint.setInitialState();</code>  <br>
<code>joint.setInitialState(init_q1, init_qd1, init_q2, init_qd2, init_q3, init_qd3);</code></p>
<p>Creation of the joints, including their offsets, damping, and initialization should be clear</p>
<ul>
<li><p>If not, review the above joint generation.</p></li>
<li><p>Note that creation of the joints is completely independent of the creation of the link shapes, and that the joint locations and functions will be the same no matter which links are attached to them.</p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="2-now-let-s-create-the-links"></a><a href="#2-now-let-s-create-the-links" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Now let's create the links</h2>
<p>Add the following to MobileRobot after <code>super(&quot;Mobile&quot;);</code></p>
<pre><code class="hljs css languages- java">
<span class="hljs-comment">// create the top (fixed) link that serves as the base of the mobile</span>
      Link topLink = <span class="hljs-keyword">new</span> Link(<span class="hljs-string">"top"</span>);
       
      LinkGraphicsDescription topLinkGraphics = <span class="hljs-keyword">new</span> LinkGraphicsDescription();
      topLinkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span> + R1 / <span class="hljs-number">2.0</span>);
      topLinkGraphics.addCylinder(L1 / <span class="hljs-number">60.0</span>, L1 / <span class="hljs-number">3.0</span>, YoAppearance.DarkBlue());
      topLink.setLinkGraphics(topLinkGraphics);
       
      <span class="hljs-keyword">this</span>.addStaticLink(topLink);

</code></pre>
<p>We start with the top link, which is a flattened cylinder.
We add it to the robot using <code>Robot.addStaticLink(Link)</code> since it is not attached to any joints and therefore cannot move.
Since the first joint of the robot had an offset of <code>(0.0, 0.0, 1.0)</code>, we need to translate to <code>(0.0, 0.0, 1.0+R1/2.0)</code> before adding this link:</p>
<p><code>Link topLink = new Link(&quot;top&quot;);</code>      <br>
<code>LinkGraphicsDescription topLinkGraphics = new LinkGraphicsDescription();</code>  <br>
<code>topLinkGraphics.translate(0.0, 0.0, 1.0+R1/2.0);</code>  <br>
<code>topLinkGraphics.addCylinder(L1/60.0, L1/3.0, YoAppearance.DarkBlue());</code>  <br>
<code>topLink.setLinkGraphics(topLinkGraphics);</code>  <br>
<code>this.addStaticLink(topLink);</code></p>
<h2><a class="anchor" aria-hidden="true" id="3-next-we-will-add-and-examine-the-steps-creating-the-crossbar-geometry"></a><a href="#3-next-we-will-add-and-examine-the-steps-creating-the-crossbar-geometry" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Next, we will add and examine the steps creating the crossbar geometry</h2>
<p>Add the following to MobileRobot:</p>
<pre><code class="hljs css languages- java">
<span class="hljs-comment">/**
    * Creates a cross bar link from the given parameters.
    */</span>
   <span class="hljs-function"><span class="hljs-keyword">private</span> Link <span class="hljs-title">crossBar</span><span class="hljs-params">(<span class="hljs-keyword">double</span> mass, <span class="hljs-keyword">double</span> length, <span class="hljs-keyword">double</span> radius, <span class="hljs-keyword">double</span> Ixx, <span class="hljs-keyword">double</span> Iyy, <span class="hljs-keyword">double</span> Izz)</span>
   </span>{
      Link ret = <span class="hljs-keyword">new</span> Link(<span class="hljs-string">"CrossBar"</span>);
      ret.setMass(mass);
      ret.setComOffset(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, -length / <span class="hljs-number">2.0</span>);
      ret.setMomentOfInertia(Ixx, Iyy, Izz);
      LinkGraphicsDescription linkGraphics = <span class="hljs-keyword">new</span> LinkGraphicsDescription();
      linkGraphics.addSphere(R1, YoAppearance.Red());
      linkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, -length / <span class="hljs-number">2.0</span>);
      linkGraphics.addCylinder(length / <span class="hljs-number">2.0</span>, radius);
      linkGraphics.identity();
      linkGraphics.translate(length, <span class="hljs-number">0.0</span>, -length / <span class="hljs-number">2.0</span>);
      linkGraphics.rotate(-Math.PI / <span class="hljs-number">2.0</span>, Axis.Y);
      linkGraphics.addCylinder(<span class="hljs-number">2.0</span> * length, radius);
      linkGraphics.addSphere(radius, YoAppearance.Red());
      linkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span> * length);
      linkGraphics.addSphere(radius, YoAppearance.Red());
      linkGraphics.identity();
      linkGraphics.translate(<span class="hljs-number">0.0</span>, length, -length / <span class="hljs-number">2.0</span>);
      linkGraphics.rotate(Math.PI / <span class="hljs-number">2.0</span>, Axis.X);
      linkGraphics.addCylinder(<span class="hljs-number">2.0</span> * length, radius);
      linkGraphics.addSphere(radius, YoAppearance.Red());
      linkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span> * length);
      linkGraphics.addSphere(radius, YoAppearance.Red());
      ret.setLinkGraphics(linkGraphics);
       
      <span class="hljs-keyword">return</span> ret;
   }
</code></pre>
<p>We first create the upper sphere-capped cylinder which projects downward. Since the origin of a cylinder is the center of its base, we must first translate down the length of the upper cylinder (length/2.0) before adding it:</p>
<p><code>linkGraphics.addSphere(R1, YoAppearance.Red());</code>  <br>
<code>linkGraphics.translate(0.0, 0.0, -length/2.0);</code>   <br>
<code>linkGraphics.addCylinder(length/2.0, radius);</code></p>
<p>Now look at creating the 2 horizontal cylinders, capped with red spheres on both ends</p>
<p>They both are created identically, except that they are translated and rotated differently. The first one is created as follows:</p>
<ul>
<li><p>This line brings us back to the gimbal joint: <code>linkGraphics.identity();</code></p></li>
<li><p>Translate down length/2.0 and in the X direction by length: <code>linkGraphics.translate(length, 0.0, -length/2.0);</code></p></li>
<li><p>Rotate by –Math.PI/2.0 about the Y axis. This will now make the Z axis point in the direction in which we wish to place our cylinder (along the original X axis): <code>linkGraphics.rotate(-Math.PI/2.0, Axis.Y);</code></p></li>
<li><p>Add the cylinder: <code>linkGraphics.addCylinder(2.0*length, radius);</code></p></li>
<li><p>Add a sphere to cap this end of the cylinder: <code>linkGraphics.addSphere(radius, YoAppearance.Red());</code></p></li>
<li><p>Translate along the Z axis to the other end of the cylinder: <code>linkGraphics.translate(0.0, 0.0, 2.0*length);</code></p></li>
<li><p>Cap the other end of the cylinder: <code>linkGraphics.addSphere(radius, YoAppearance.Red());</code></p></li>
</ul>
<p>The second cylinder is identical to the first, except for the initial translation and rotation</p>
<ul>
<li><p>Translate down length/2.0 and in the Y direction by length: <code>linkGraphics.translate(0.0, length, -length/2.0);</code></p></li>
<li><p>Rotate by Math.PI/2.0 about the X axis. This will now make the Z axis point in the direction in which we wish to place our cylinder (along the original Y axis): <code>linkGraphics.rotate(Math.PI/2.0, Axis.X);</code></p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="4-add-the-following-randomshape-code-to-the-mobilerobot-class"></a><a href="#4-add-the-following-randomshape-code-to-the-mobilerobot-class" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Add the following randomShape code to the MobileRobot Class</h2>
<p>This method will randomly select a string length, an appearance and a shape for each of the 16 toys at the ends of the mobile. How this code works should now be clear to you.</p>
<p>If not, try to experiment with it, or try making a simulation of a different style of mobile to become comfortable with joints and links.</p>
<pre><code class="hljs css languages- java">   <span class="hljs-comment">/**
    * Generates a random link shape with a thin cylinder attached to represent a string.
    * The toys are generated from one of 9 colors and 7 shapes.
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> Link <span class="hljs-title">randomShape</span><span class="hljs-params">()</span>
    </span>{
      Link ret = <span class="hljs-keyword">new</span> Link(<span class="hljs-string">"randomShape"</span>);
      <span class="hljs-keyword">double</span> stringLength = L3 * (<span class="hljs-number">1.0</span> + <span class="hljs-number">2.0</span> * Math.random());
      ret.setMass(M3);
      <span class="hljs-comment">// assume a massless string</span>
      ret.setComOffset(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, -stringLength);
      ret.setMomentOfInertia(Ixx3, Iyy3, Izz3);
      LinkGraphicsDescription linkGraphics = <span class="hljs-keyword">new</span> LinkGraphicsDescription();
      linkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, -stringLength);
      linkGraphics.addCylinder(stringLength, R3);
      AppearanceDefinition app = YoAppearance.Black();
      <span class="hljs-keyword">int</span> appSelection = (<span class="hljs-keyword">int</span>) (Math.random() * <span class="hljs-number">9.0</span>);
      <span class="hljs-keyword">switch</span> (appSelection)
      {
         <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> :
            app = YoAppearance.Black();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">1</span> :
            app = YoAppearance.Red();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">2</span> :
            app = YoAppearance.DarkRed();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">3</span> :
            app = YoAppearance.Green();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">4</span> :
            app = YoAppearance.DarkGreen();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">5</span> :
            app = YoAppearance.Blue();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">6</span> :
            app = YoAppearance.DarkBlue();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">7</span> :
            app = YoAppearance.AluminumMaterial();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">8</span> :
            app = YoAppearance.BlackMetalMaterial();
            <span class="hljs-keyword">break</span>;
      }
      <span class="hljs-keyword">int</span> toySelection = (<span class="hljs-keyword">int</span>) (Math.random() * <span class="hljs-number">7.0</span>);
      <span class="hljs-keyword">switch</span> (toySelection)
      {
         <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> :
            linkGraphics.addSphere(TOY_R, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">1</span> :
            linkGraphics.addCylinder(TOY_H, TOY_R, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">2</span> :
            linkGraphics.addCube(TOY_L, TOY_W, TOY_H, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">3</span> :
            linkGraphics.addCone(TOY_H, TOY_R, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">4</span> :
            linkGraphics.addEllipsoid(TOY_L, TOY_W, TOY_H, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">5</span> :
            linkGraphics.addHemiEllipsoid(TOY_L, TOY_W, TOY_H, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">6</span> :
            linkGraphics.addGenTruncatedCone(TOY_H, TOY_L, TOY_W, TOY_W, TOY_L, app);
      }
      ret.setLinkGraphics(linkGraphics);
      <span class="hljs-keyword">return</span> ret;
   }
</code></pre>
<p>For more detailed information on joints check out the <a href="https://ihmcroboticsdocs.github.io/simulation-construction-set/docs/01-definition-robot.html">Robots and Joint API Page</a></p>
<h2><a class="anchor" aria-hidden="true" id="full-code-for-classes"></a><a href="#full-code-for-classes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Full Code for Classes</h2>
<p><details>
<summary>MobileSimulation Class</summary></p>
<pre><code class="hljs css languages- java"><span class="hljs-keyword">package</span> us.ihmc.exampleSimulations.mobile;
<span class="hljs-keyword">import</span> us.ihmc.simulationconstructionset.SimulationConstructionSet;
<span class="hljs-comment">/**
 * A simulation of a child’s mobile toy that uses a tree structure of 21 gimbal
 * joints (63 degrees of freedom total).
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MobileSimulation</span>
</span>{
   <span class="hljs-keyword">private</span> SimulationConstructionSet sim;
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MobileSimulation</span><span class="hljs-params">()</span>
   </span>{
      <span class="hljs-comment">// Create an instance of MobileRobot</span>
      MobileRobot mobile = <span class="hljs-keyword">new</span> MobileRobot();
      <span class="hljs-comment">// Instantiate a SCS object using the MobileRobot object reference</span>
      sim = <span class="hljs-keyword">new</span> SimulationConstructionSet(mobile);
      sim.setGroundVisible(<span class="hljs-keyword">false</span>);
      sim.setCameraTracking(<span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>);
      sim.setCameraDolly(<span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>, <span class="hljs-keyword">false</span>);
      <span class="hljs-comment">// set camera to a convenient viewing angle</span>
      sim.setCameraPosition(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">0.5</span>);
      sim.setCameraFix(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.8</span>);
      sim.setCameraTrackingVars(<span class="hljs-string">"ef_track00_x"</span>, <span class="hljs-string">"ef_track00_y"</span>, <span class="hljs-string">"ef_track00_z"</span>);
      sim.setDT(<span class="hljs-number">0.02</span>, <span class="hljs-number">1</span>);
      Thread myThread = <span class="hljs-keyword">new</span> Thread(sim);
      myThread.start();
   }
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span>
   </span>{
      <span class="hljs-keyword">new</span> MobileSimulation();
   }
}
</code></pre>
<p></details>
<details>
<summary>MobileRobot Class</summary></p>
<pre><code class="hljs css languages- java">
<span class="hljs-keyword">package</span> us.ihmc.exampleSimulations.mobile;
 
<span class="hljs-keyword">import</span> javax.vecmath.Vector3d;
<span class="hljs-keyword">import</span> us.ihmc.robotics.robotDescription.LinkGraphicsDescription;
<span class="hljs-keyword">import</span> us.ihmc.graphicsDescription.appearance.YoAppearance;
<span class="hljs-keyword">import</span> us.ihmc.graphicsDescription.appearance.AppearanceDefinition;
<span class="hljs-keyword">import</span> us.ihmc.robotics.Axis;
<span class="hljs-keyword">import</span> us.ihmc.simulationconstructionset.ExternalForcePoint;
<span class="hljs-keyword">import</span> us.ihmc.simulationconstructionset.GimbalJoint;
<span class="hljs-keyword">import</span> us.ihmc.simulationconstructionset.Joint;
<span class="hljs-keyword">import</span> us.ihmc.simulationconstructionset.Link;
<span class="hljs-keyword">import</span> us.ihmc.simulationconstructionset.Robot;
 
<span class="hljs-comment">/**
 * MobileRobot is a representation of a child's mobile toy that uses a tree structure of 21 gimbal
 * joints (63 degrees of freedom total).
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MobileRobot</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Robot</span>
</span>{
    
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = -<span class="hljs-number">5838475007549333013L</span>;
    
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>
      L1 = <span class="hljs-number">0.3</span>, M1 = <span class="hljs-number">0.1</span>, R1 = <span class="hljs-number">0.01</span>, Ixx1 = <span class="hljs-number">0.01</span>, Iyy1 = <span class="hljs-number">0.01</span>, Izz1 = <span class="hljs-number">0.01</span>;
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>
      L2 = <span class="hljs-number">0.12</span>, M2 = <span class="hljs-number">0.05</span>, R2 = <span class="hljs-number">0.005</span>, Ixx2 = <span class="hljs-number">0.01</span>, Iyy2 = <span class="hljs-number">0.01</span>, Izz2 = <span class="hljs-number">0.01</span>;
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>
      L3 = <span class="hljs-number">0.08</span>, M3 = <span class="hljs-number">0.03</span>, R3 = <span class="hljs-number">0.001</span>, Ixx3 = <span class="hljs-number">0.01</span>, Iyy3 = <span class="hljs-number">0.01</span>, Izz3 = <span class="hljs-number">0.01</span>;;
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>
      TOY_L = <span class="hljs-number">0.02</span>, TOY_W = <span class="hljs-number">0.04</span>, TOY_H = <span class="hljs-number">0.03</span>, TOY_R = <span class="hljs-number">0.02</span>;
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span>
      DAMP1 = <span class="hljs-number">0.06</span>, DAMP2 = <span class="hljs-number">0.006</span>, DAMP3 = <span class="hljs-number">0.003</span>;
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MobileRobot</span><span class="hljs-params">()</span>
   </span>{
      <span class="hljs-keyword">super</span>(<span class="hljs-string">"Mobile"</span>);
      <span class="hljs-comment">// create the top (fixed) link that serves as the base of the mobile</span>
      Link topLink = <span class="hljs-keyword">new</span> Link(<span class="hljs-string">"top"</span>);
       
      LinkGraphicsDescription topLinkGraphics = <span class="hljs-keyword">new</span> LinkGraphicsDescription();
      topLinkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span> + R1 / <span class="hljs-number">2.0</span>);
      topLinkGraphics.addCylinder(L1 / <span class="hljs-number">60.0</span>, L1 / <span class="hljs-number">3.0</span>, YoAppearance.DarkBlue());
      topLink.setLinkGraphics(topLinkGraphics);
       
      <span class="hljs-keyword">this</span>.addStaticLink(topLink);
      <span class="hljs-comment">// create first gimbal joint at the top of the mobile</span>
      GimbalJoint firstGimbal = <span class="hljs-keyword">new</span> GimbalJoint(<span class="hljs-string">"gimbal_x"</span>, <span class="hljs-string">"gimbal_y"</span>, <span class="hljs-string">"gimbal_z"</span>, 
                                                <span class="hljs-keyword">new</span> Vector3d(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>), <span class="hljs-keyword">this</span>, Axis.X, Axis.Y, Axis.Z);
      <span class="hljs-comment">// attach a crossbar to the top gimbal joint</span>
      Link bar1 = crossBar(M1, L1, R1, Ixx1, Iyy1, Izz1);
      firstGimbal.setLink(bar1);
      firstGimbal.setDamping(DAMP1);
      initJoint(firstGimbal);
      <span class="hljs-keyword">this</span>.addRootJoint(firstGimbal);
      <span class="hljs-keyword">double</span> xOffset, yOffset;
      GimbalJoint nextGimbal;
      GimbalJoint finalGimbal;
      Link nextLink;
      <span class="hljs-comment">// for each point of the cross bar, attach a new gimbal joint and (smaller crossbar)</span>
      <span class="hljs-comment">// four toys will hang from each of these smaller crossbars</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)
      {
         xOffset = <span class="hljs-number">0.0</span>;
         yOffset = <span class="hljs-number">0.0</span>;
         <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>)
            xOffset = L1;
         <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">1</span>)
            xOffset = -L1;
         <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">2</span>)
            yOffset = L1;
         <span class="hljs-keyword">else</span> <span class="hljs-comment">// i == 3</span>
            yOffset = -L1;
         nextGimbal = <span class="hljs-keyword">new</span> GimbalJoint(<span class="hljs-string">"gimbal1_"</span> + i + <span class="hljs-string">"_x"</span>, <span class="hljs-string">"gimbal1_"</span> + i + <span class="hljs-string">"_y"</span>, <span class="hljs-string">"gimbal1_"</span> + i + <span class="hljs-string">"_z"</span>,
                                      <span class="hljs-keyword">new</span> Vector3d(xOffset, yOffset, -L1 / <span class="hljs-number">2.0</span>), <span class="hljs-keyword">this</span>, Axis.X, Axis.Y, Axis.Z);
         nextLink = crossBar(M2, L2, R2, Ixx2, Iyy2, Izz2);
         nextGimbal.setLink(nextLink);
         nextGimbal.setDamping(DAMP2);
         initJoint(nextGimbal);
         firstGimbal.addJoint(nextGimbal);
         <span class="hljs-comment">// for each point of the smaller crossbar, add a gimbal joint with a "toy" link attached</span>
         <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">4</span>; j++)
         {
            xOffset = <span class="hljs-number">0.0</span>;
            yOffset = <span class="hljs-number">0.0</span>;
            <span class="hljs-keyword">if</span> (j == <span class="hljs-number">0</span>)
               xOffset = L2;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j == <span class="hljs-number">1</span>)
               xOffset = -L2;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j == <span class="hljs-number">2</span>)
               yOffset = L2;
            <span class="hljs-keyword">else</span> <span class="hljs-comment">// j == 3</span>
               yOffset = -L2;
            finalGimbal = <span class="hljs-keyword">new</span> GimbalJoint(<span class="hljs-string">"gimbal2_"</span> + i + <span class="hljs-string">"_"</span> + j + <span class="hljs-string">"_x"</span>, <span class="hljs-string">"gimbal2_"</span> + i + <span class="hljs-string">"_"</span> + j +  <span class="hljs-string">"_y"</span>, <span class="hljs-string">"gimbal2_"</span>
                                          + i + <span class="hljs-string">"_"</span> + j +  <span class="hljs-string">"_z"</span>, <span class="hljs-keyword">new</span> Vector3d(xOffset, yOffset, -L2 / <span class="hljs-number">2.0</span>), <span class="hljs-keyword">this</span>,
                                          Axis.X, Axis.Y, Axis.Z);
             
            <span class="hljs-comment">// generate a random toy link and attach it to gimbal</span>
            nextLink = randomShape();
            finalGimbal.setLink(nextLink);
            <span class="hljs-comment">// add external force point at the toy COM</span>
            Vector3d offset = <span class="hljs-keyword">new</span> Vector3d();
            nextLink.getComOffset(offset);
            ExternalForcePoint point = <span class="hljs-keyword">new</span> ExternalForcePoint(<span class="hljs-string">"ef_track"</span> + i + j, offset, <span class="hljs-keyword">this</span>);
            finalGimbal.addExternalForcePoint(point);
            finalGimbal.setDamping(DAMP3);
            initJoint(finalGimbal);
            nextGimbal.addJoint(finalGimbal);
         }
      }
   }
   <span class="hljs-comment">/**
    * Initializes a GimbalJoint to a random initial position and velocity.
    */</span>
   <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initJoint</span><span class="hljs-params">(GimbalJoint joint)</span>
   </span>{
      <span class="hljs-keyword">double</span> init_q1 = (<span class="hljs-number">2.0</span> * Math.random() - <span class="hljs-number">1.0</span>) * <span class="hljs-number">0.25</span>;
      <span class="hljs-keyword">double</span> init_q2 = (<span class="hljs-number">2.0</span> * Math.random() - <span class="hljs-number">1.0</span>) * <span class="hljs-number">0.25</span>;
      <span class="hljs-keyword">double</span> init_q3 = (<span class="hljs-number">2.0</span> * Math.random() - <span class="hljs-number">1.0</span>) * Math.PI;
      <span class="hljs-keyword">double</span> init_qd1 = (<span class="hljs-number">2.0</span> * Math.random() - <span class="hljs-number">1.0</span>) * <span class="hljs-number">0.5</span>;
      <span class="hljs-keyword">double</span> init_qd2 = (<span class="hljs-number">2.0</span> * Math.random() - <span class="hljs-number">1.0</span>) * <span class="hljs-number">0.5</span>;
      <span class="hljs-keyword">double</span> init_qd3 = (<span class="hljs-number">2.0</span> * Math.random() - <span class="hljs-number">1.0</span>) * <span class="hljs-number">2.0</span>;
      joint.setInitialState(init_q1, init_qd1, init_q2, init_qd2, init_q3, init_qd3);
   }
   <span class="hljs-comment">/**
    * Creates a cross bar link from the given parameters.
    */</span>
   <span class="hljs-function"><span class="hljs-keyword">private</span> Link <span class="hljs-title">crossBar</span><span class="hljs-params">(<span class="hljs-keyword">double</span> mass, <span class="hljs-keyword">double</span> length, <span class="hljs-keyword">double</span> radius, <span class="hljs-keyword">double</span> Ixx, <span class="hljs-keyword">double</span> Iyy, <span class="hljs-keyword">double</span> Izz)</span>
   </span>{
      Link ret = <span class="hljs-keyword">new</span> Link(<span class="hljs-string">"CrossBar"</span>);
      ret.setMass(mass);
      ret.setComOffset(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, -length / <span class="hljs-number">2.0</span>);
      ret.setMomentOfInertia(Ixx, Iyy, Izz);
      LinkGraphicsDescription linkGraphics = <span class="hljs-keyword">new</span> LinkGraphicsDescription();
      linkGraphics.addSphere(R1, YoAppearance.Red());
      linkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, -length / <span class="hljs-number">2.0</span>);
      linkGraphics.addCylinder(length / <span class="hljs-number">2.0</span>, radius);
      linkGraphics.identity();
      linkGraphics.translate(length, <span class="hljs-number">0.0</span>, -length / <span class="hljs-number">2.0</span>);
      linkGraphics.rotate(-Math.PI / <span class="hljs-number">2.0</span>, Axis.Y);
      linkGraphics.addCylinder(<span class="hljs-number">2.0</span> * length, radius);
      linkGraphics.addSphere(radius, YoAppearance.Red());
      linkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span> * length);
      linkGraphics.addSphere(radius, YoAppearance.Red());
      linkGraphics.identity();
      linkGraphics.translate(<span class="hljs-number">0.0</span>, length, -length / <span class="hljs-number">2.0</span>);
      linkGraphics.rotate(Math.PI / <span class="hljs-number">2.0</span>, Axis.X);
      linkGraphics.addCylinder(<span class="hljs-number">2.0</span> * length, radius);
      linkGraphics.addSphere(radius, YoAppearance.Red());
      linkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">2.0</span> * length);
      linkGraphics.addSphere(radius, YoAppearance.Red());
      ret.setLinkGraphics(linkGraphics);
       
      <span class="hljs-keyword">return</span> ret;
   }
   <span class="hljs-comment">/**
    * Generates a random link shape with a thin cylinder attached to represent a string.
    * The toys are generated from one of 9 colors and 7 shapes.
    */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> Link <span class="hljs-title">randomShape</span><span class="hljs-params">()</span>
    </span>{
      Link ret = <span class="hljs-keyword">new</span> Link(<span class="hljs-string">"randomShape"</span>);
      <span class="hljs-keyword">double</span> stringLength = L3 * (<span class="hljs-number">1.0</span> + <span class="hljs-number">2.0</span> * Math.random());
      ret.setMass(M3);
      <span class="hljs-comment">// assume a massless string</span>
      ret.setComOffset(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, -stringLength);
      ret.setMomentOfInertia(Ixx3, Iyy3, Izz3);
      LinkGraphicsDescription linkGraphics = <span class="hljs-keyword">new</span> LinkGraphicsDescription();
      linkGraphics.translate(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, -stringLength);
      linkGraphics.addCylinder(stringLength, R3);
      AppearanceDefinition app = YoAppearance.Black();
      <span class="hljs-keyword">int</span> appSelection = (<span class="hljs-keyword">int</span>) (Math.random() * <span class="hljs-number">9.0</span>);
      <span class="hljs-keyword">switch</span> (appSelection)
      {
         <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> :
            app = YoAppearance.Black();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">1</span> :
            app = YoAppearance.Red();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">2</span> :
            app = YoAppearance.DarkRed();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">3</span> :
            app = YoAppearance.Green();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">4</span> :
            app = YoAppearance.DarkGreen();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">5</span> :
            app = YoAppearance.Blue();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">6</span> :
            app = YoAppearance.DarkBlue();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">7</span> :
            app = YoAppearance.AluminumMaterial();
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">8</span> :
            app = YoAppearance.BlackMetalMaterial();
            <span class="hljs-keyword">break</span>;
      }
      <span class="hljs-keyword">int</span> toySelection = (<span class="hljs-keyword">int</span>) (Math.random() * <span class="hljs-number">7.0</span>);
      <span class="hljs-keyword">switch</span> (toySelection)
      {
         <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> :
            linkGraphics.addSphere(TOY_R, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">1</span> :
            linkGraphics.addCylinder(TOY_H, TOY_R, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">2</span> :
            linkGraphics.addCube(TOY_L, TOY_W, TOY_H, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">3</span> :
            linkGraphics.addCone(TOY_H, TOY_R, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">4</span> :
            linkGraphics.addEllipsoid(TOY_L, TOY_W, TOY_H, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">5</span> :
            linkGraphics.addHemiEllipsoid(TOY_L, TOY_W, TOY_H, app);
            <span class="hljs-keyword">break</span>;
         <span class="hljs-keyword">case</span> <span class="hljs-number">6</span> :
            linkGraphics.addGenTruncatedCone(TOY_H, TOY_L, TOY_W, TOY_W, TOY_L, app);
      }
      ret.setLinkGraphics(linkGraphics);
      <span class="hljs-keyword">return</span> ret;
   }
}

</code></pre>
<p></details></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/simulation-construction-set/docs/03-mobile-robot.html">← Initial Variables in MobileRobot Class</a><a class="docs-next button" href="/simulation-construction-set/docs/004-summary.html">Summary →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#1-add-the-following-code-to-the-mobilerobot-class">1. Add the following code to the MobileRobot Class</a></li><li><a href="#2-now-let-s-create-the-links">2. Now let's create the links</a></li><li><a href="#3-next-we-will-add-and-examine-the-steps-creating-the-crossbar-geometry">3. Next, we will add and examine the steps creating the crossbar geometry</a></li><li><a href="#4-add-the-following-randomshape-code-to-the-mobilerobot-class">4. Add the following randomShape code to the MobileRobot Class</a></li><li><a href="#full-code-for-classes">Full Code for Classes</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/simulation-construction-set/" class="nav-home"><img src="/simulation-construction-set/img/running-man-logo.png" alt="Simulation Construction Set" width="66" height="58"/></a><div><h5>Docs</h5><a href="https://ihmcroboticsdocs.github.io/ihmc-open-robotics-software/docs/quickstarthome.html">Quick Start</a><a href="https://ihmcroboticsdocs.github.io/docs/docshome.html">Software Documentation</a></div><div><h5>Community</h5><a href="https://github.com/ihmcrobotics">GitHub</a><a href="https://www.facebook.com/TheIHMC" target="_blank" rel="noreferrer noopener">Facebook</a><a href="https://twitter.com/ihmcrobotics" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://www.youtube.com/user/DRCihmcRobotics" target="_blank" rel="noreferrer noopener">YouTube</a></div></section><section class="copyright">Copyright © 2018 IHMC Robotics</section></footer></div></body></html>